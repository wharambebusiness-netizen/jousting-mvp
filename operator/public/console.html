<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Console â€” Operator</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <link rel="stylesheet" href="/style.css">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' fill='none'%3E%3Cpath d='M16 5L4 12l12 6 12-6L16 5z' stroke='%236366f1' stroke-width='2' stroke-linejoin='round'/%3E%3Cpath d='M4 16l12 6 12-6' stroke='%23818cf8' stroke-width='2' stroke-linejoin='round'/%3E%3Cpath d='M4 21l12 6 12-6' stroke='%2322d3ee' stroke-width='2' stroke-linejoin='round'/%3E%3C/svg%3E">
  <script src="https://unpkg.com/htmx.org@2.0.4/dist/htmx.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/css/xterm.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.min.js"></script>
</head>
<body class="has-sidebar" hx-boost="true">
  <div class="htmx-progress" id="progress-bar"></div>

  <aside class="sidebar-nav" id="sidebar-nav">
    <a href="/" class="sidebar-nav__brand"><span class="sidebar-nav__brand-icon"><svg viewBox="0 0 32 32" fill="none"><path d="M16 5L4 12l12 6 12-6L16 5z" stroke="#6366f1" stroke-width="2" stroke-linejoin="round"/><path d="M4 16l12 6 12-6" stroke="#818cf8" stroke-width="2" stroke-linejoin="round"/><path d="M4 21l12 6 12-6" stroke="#22d3ee" stroke-width="2" stroke-linejoin="round"/></svg></span><span class="sidebar-nav__brand-text">Operator</span></a>
    <ul class="sidebar-nav__links">
      <li><a href="/dashboard" class="sidebar-nav__link" data-page="/dashboard"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="6" height="6" rx="1"/><rect x="11" y="3" width="6" height="6" rx="1"/><rect x="3" y="11" width="6" height="6" rx="1"/><rect x="11" y="11" width="6" height="6" rx="1"/></svg></span><span class="sidebar-nav__label">Dashboard</span></a></li>
      <li><a href="/console" class="sidebar-nav__link" data-page="/console"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="16" height="14" rx="2"/><path d="M5 8l3 2.5L5 13"/><line x1="10" y1="13" x2="15" y2="13"/><circle cx="15" cy="8" r="1.5"/></svg></span><span class="sidebar-nav__label">Console</span></a></li>
      <li><a href="/terminals" class="sidebar-nav__link" data-page="/terminals"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="14" height="14" rx="2"/><path d="M6 8l3 2.5L6 13"/><line x1="11" y1="13" x2="14" y2="13"/></svg></span><span class="sidebar-nav__label">Terminals</span></a></li>
      <li><a href="/taskboard" class="sidebar-nav__link" data-page="/taskboard"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 4h8a2 2 0 012 2v8a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"/><path d="M7 8h6M7 11h4"/></svg></span><span class="sidebar-nav__label">Tasks</span></a></li>
      <li><a href="/timeline" class="sidebar-nav__link" data-page="/timeline"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3v14"/><circle cx="10" cy="6" r="2"/><circle cx="10" cy="11" r="2"/><circle cx="10" cy="16" r="1.5"/></svg></span><span class="sidebar-nav__label">Timeline</span></a></li>
      <li><a href="/projects" class="sidebar-nav__link" data-page="/projects"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 5.5A1.5 1.5 0 014.5 4h3.172a1.5 1.5 0 011.06.44L10 5.706a1.5 1.5 0 001.06.44H15.5A1.5 1.5 0 0117 7.646V14.5a1.5 1.5 0 01-1.5 1.5h-11A1.5 1.5 0 013 14.5V5.5z"/></svg></span><span class="sidebar-nav__label">Projects</span></a></li>
      <li><a href="/settings" class="sidebar-nav__link" data-page="/settings"><span class="sidebar-nav__icon"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="10" cy="10" r="2.5"/><path d="M10 2.5v2M10 15.5v2M2.5 10h2M15.5 10h2M4.4 4.4l1.4 1.4M14.2 14.2l1.4 1.4M4.4 15.6l1.4-1.4M14.2 5.8l1.4-1.4"/></svg></span><span class="sidebar-nav__label">Settings</span></a></li>
    </ul>
    <div class="sidebar-nav__footer"><span class="sidebar-nav__ws-dot" id="ws-dot" title="WebSocket: connecting" aria-label="WebSocket status" role="status"></span><span class="sidebar-nav__ws-label">WebSocket</span></div>
    <div class="sidebar-nav__footer"><select id="project-select" class="sidebar-nav__project" onchange="onProjectChange(this.value)"><option value="">All Projects</option></select></div>
  </aside>

  <main class="page console-page">
    <header class="console-header">
      <h2>Master Console</h2>
      <div class="console-header__actions">
        <span class="console-header__status" id="master-status">No master terminal</span>
        <button class="btn btn--sm btn--primary" id="start-master-btn">Start Master</button>
        <button class="btn btn--sm btn--ghost" id="stop-master-btn" style="display:none">Stop Master</button>
        <span class="console-header__separator"></span>
        <button class="btn btn--xs btn--ghost" id="swarm-btn" title="Start/Stop Swarm">Swarm</button>
        <button class="btn btn--xs btn--ghost" id="create-task-btn" title="Create Task">+ Task</button>
        <button class="btn btn--xs btn--ghost" id="toggle-tasks-btn" title="Toggle task panel">Tasks</button>
        <button class="btn btn--xs btn--ghost" id="health-btn" title="System Health">Health</button>
      </div>
    </header>

    <div class="console-layout">
      <!-- Master Terminal Panel -->
      <div class="console-master" id="master-panel">
        <div class="console-master__placeholder" id="master-placeholder">
          <div class="console-master__placeholder-content">
            <div class="console-master__placeholder-icon"><svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="width:48px;height:48px;opacity:.4"><rect x="4" y="8" width="40" height="32" rx="4"/><path d="M12 20l6 5-6 5"/><line x1="22" y1="30" x2="36" y2="30"/><circle cx="36" cy="20" r="3"/></svg></div>
            <p>Click <strong>Start Master</strong> to launch the master Claude terminal.</p>
            <p class="console-master__placeholder-hint">The master plans work, creates tasks, and coordinates worker terminals.</p>
          </div>
        </div>
        <div class="console-master__terminal" id="master-terminal-container" style="display:none"></div>
        <div class="console-prompt" id="master-prompt" style="display:none">
          <textarea id="master-prompt-input" rows="2" placeholder="What would you like to build? Describe your goal and the master will plan the work..."></textarea>
          <div class="console-prompt__actions">
            <button class="btn btn--sm btn--primary" id="send-prompt-btn">Send to Master</button>
            <button class="btn btn--sm btn--ghost" id="skip-prompt-btn">Skip</button>
            <span class="console-prompt__hint">Ctrl+Enter to send</span>
          </div>
        </div>
      </div>

      <!-- Worker Panel -->
      <div class="console-workers" id="worker-panel">
        <div class="console-workers__header">
          <h3>Workers</h3>
          <button class="btn btn--sm btn--ghost" id="spawn-worker-btn" title="Spawn worker">+</button>
        </div>
        <div class="console-workers__list" id="worker-list">
          <div class="console-workers__empty" id="worker-empty">
            <p>No workers active.</p>
            <p class="console-workers__hint">The master can spawn workers, or use the + button.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Inline Task Panel -->
    <div class="console-taskpanel" id="task-panel" style="display:none">
      <div class="console-taskpanel__header">
        <h4>Tasks</h4>
        <button class="btn btn--xs btn--ghost" id="close-task-panel-btn" title="Close task panel">&times;</button>
      </div>
      <div class="console-taskpanel__list" id="task-list">
        <p class="console-taskpanel__empty">No tasks yet.</p>
      </div>
    </div>

    <!-- Create Task Dialog -->
    <dialog class="console-dialog" id="create-task-dialog">
      <form class="console-dialog__form" id="create-task-form">
        <h4>Create Task</h4>
        <input type="text" id="task-title-input" placeholder="Task title" required>
        <textarea id="task-desc-input" rows="3" placeholder="Task description (optional)"></textarea>
        <div class="console-dialog__actions">
          <button type="submit" class="btn btn--sm btn--primary">Create</button>
          <button type="button" class="btn btn--sm btn--ghost" id="cancel-task-btn">Cancel</button>
        </div>
      </form>
    </dialog>

    <!-- Status Bar -->
    <div class="console-statusbar" id="status-bar">
      <div class="console-statusbar__tasks">
        <span class="console-statusbar__label">Tasks:</span>
        <div class="console-statusbar__progress">
          <div class="console-statusbar__progress-fill" id="task-progress-fill"></div>
        </div>
        <span class="console-statusbar__count" id="task-count">0/0</span>
      </div>
      <div class="console-statusbar__info">
        <span id="cost-display">Cost: $0.00</span>
        <span id="worker-count-display">Workers: 0</span>
      </div>
    </div>
  </main>

  <div id="toast-container"></div>
  <script src="/app.js"></script>
  <script src="/console.js"></script>
</body>
</html>
